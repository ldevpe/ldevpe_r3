<%- include part1.ejs %>  
  <title>Discussion Forum | L`devpe`</title>
<%- include part2.ejs %>

  <link href="https://fonts.googleapis.com/css?family=Nunito&display=swap" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
  <style type="text/css">
  .button {
  display: inline-block;
  border-radius: 4px;
  background-color:cornflowerblue;
  border: none;
  color: #FFFFFF;
  text-align: center;
  font-size: 20px;
  padding: 10px;
  width: 18rem;
  transition: all 0.5s;
  cursor: pointer;
  margin: 5px;
}

.button span {
  cursor: pointer;
  display: inline-block;
  position: relative;
  transition: 0.5s;
}

.button span:after {
  position: absolute;
  opacity: 0;
  top: 0;
  right: -20px;
  transition: 0.5s;
}

.button:hover span {
  padding-right: 25px;
}

.button:hover span:after {
  opacity: 1;
  right: 0;
}
    .card {
  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
  transition: 0.3s;
  width: 100%;
}

.card:hover {
  box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
}

.container {
  padding: 2px 16px;
}
    .divLeft {
        width:fit-content;
        display:block;
        float: left;
        margin-left: 3rem;
        margin-bottom: 2rem;
    }
    .divRight {
        width:70%;
        display:block;
        float: right;
        margin-right: 3rem;
        margin-bottom: 20rem;
    }
    #rcorners2 {
    font-family: 'Nunito', sans-serif;
    font-size: larger;
     border-radius: 15px  120px 30px;
     background:darkblue;
     padding-left: 2.5rem;
     padding-top: 0.5rem;
     padding-bottom: 0.5rem;
     margin-top: 1rem;
     width: 15rem;
     height: 3rem;
     color: white;
     display:block;
    }
    #rcorners2:hover{
        background:dodgerblue;
        color: white;
      
    }
    #rcorners2:active{
        background:dodgerblue;
        color: white;
    }
    .dot {
    height: 10px;
    width: 10px;
    background-color: #bbb;
    border-radius: 50%;
    margin-left: 1rem;
    display: inline-block;
    }
    .user_name{
        font-family: 'Nunito', sans-serif;
        color: blueviolet;
        font-weight: bold;
    }
    .reply_info{
        font-family: 'Nunito', sans-serif;
        margin-left: 1rem;
    }
    .reply_count{
        font-family: 'Nunito', sans-serif;
    }
    .html{
        background:black;
        color: white;
    }
    .css{
        background: #4CAF50;
        color: white;
    }
    .bootstrap{
        background:#f4511e;
        color: white;    
    }
    .js{
        background:#0000FF;
        color: white;
    
    }
    .angularJS{
        background:#000080;
        color: white;
    
    }
    .jQuery{
        background:#800080;
        color: white;
    
    }

    .json{
        background:#FF00FF;
        color: white;
    }
    .ajax{
        background:#800000;
        color: white;
    }
    .react{
        background:#808000;
        color: white;
    }
    .php{
        background:#00FF00;
        color: white;
    }
    .sql{
        background:#008000;
        color: white;
    }
    .asp{
        background:#00FFFF;
        color: white;
    }
    .nodejs{
        background:#008080;
        color: white;
    }
    .contain {
  display: block;
  position: relative;
  padding-left: 35px;
  margin-bottom: 12px;
  cursor: pointer;
  font-size: 22px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.contain input {
  position: absolute;
  opacity: 0;
  cursor: pointer;
  height: 0;
  width: 0;
}

.checkmark {
  position: absolute;
  top: 0;
  left: 0;
  height: 25px;
  width: 25px;
  background-color: #eee;
}

.contain:hover input ~ .checkmark {
  background-color: #ccc;
}

.contain input:checked ~ .checkmark {
  background-color: red;
}

.checkmark:after {
  content: "";
  position: absolute;
  display: none;
}

.contain input:checked ~ .checkmark:after {
  display: block;
}
.like_b{
  transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);
  background-color: hsla(240, 100%, 50%, 0.2);
  border: 3px solid #0000FF;
  color: black;
  font-size: 16px;
  padding: 16px 30px;
  cursor: pointer;
  border-radius: 5px;
  text-align: center;
 margin-top: 1rem;
 margin-left: 5rem;
}
.like_b:hover{
    background-color: black;
  color: white;
}
.contain .checkmark:after {
  left: 9px;
  top: 5px;
  width: 5px;
  height: 10px;
  border: solid white;
  border-width: 0 3px 3px 0;
  -webkit-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  transform: rotate(45deg);
}
    </style>
</head>
<body>
        <%- include body1.ejs %>
        <div class="navbar-buttons mbr-section-btn">
                <a class="btn btn-sm btn-success-outline display-4" href="/takeaways/0" style="color: white;">Take aways</a>
            <a class="btn btn-sm btn-success-outline display-4" href="/disc/0" style="color: white;border-color: #0000FF;">Forum</a> <a class="btn btn-sm btn-secondary-outline display-4" href="/profile" style="color: white;">Profile</a> <a class="btn btn-sm btn-white-outline display-4" href="/challenger" style="color: white;">C Week</a> <a class="btn btn-sm btn-primary-outline display-4" href="/resources" style="color: white;">Links</a> <a class="btn btn-sm btn-secondary-outline display-4" href="/daily_practice" target="_blank" style="color: white;">Editor</a></div>
     </div>
    </nav>
</section>
<section class="engine"><a href="https://google.com">web maker</a></section><section class="z6 mbr-parallax-background" id="header2-3a">
    <div class="mbr-overlay" style="background-color: black;"></div>
    <div class="container align-center">
        <div class="row justify-content-md-center">
            <div class="mbr-white col-md-10">
                <h1 class="mbr-section-title mbr-bold pb-3 mbr-fonts-style display-2" style="color: white;">
                    Discussion Forum</h1>
                <p class="mbr-text pb-3 mbr-fonts-style display-5" style="color:white">View all discussions and latest posts here</p>
                <div class="mbr-section-btn"><p class="btn btn-md btn-black display-4" onclick="f3()" style="border-radius: 1rem;"># POST QUESTION</p></div>
            </div>
        </div>
    </div>
    <div class="mbr-arrow hidden-sm-down" aria-hidden="true">
        <a href="#divMain">
            <i class="mbri-down mbr-iconfont"></i>
        </a>
    </div>
</section>
<script>
    function f3()
    {
        var inside = document.getElementById("add_question").style.display;
        if(inside == "none")
        {
            document.getElementById("add_question").style.display = "block";
        }
        else{
            document.getElementById("add_question").style.display = "none";
        }
    }
    function f1(num,num1)
    {
        var d1 = "class";
        d1 = d1 + num;
        var b1 = "b";
        b1 = b1 + num;
        console.log(d1);
        var inside = document.getElementById(d1).style.display;
        if(inside == "none")
        {
            document.getElementById(d1).style.display = "block";
            document.getElementById(b1).innerText = "Hide all replies";
            fun1(num,num1);
        }
        else
        {
            document.getElementById(d1).style.display = "none";
            document.getElementById(b1).innerText = "View all replies";
        }
    }
    function f2(num)
    {
        var d1 = "reply_class";
        d1 = d1 + num;
        var b1 = "reply";
        b1 = b1 + num;
        console.log(d1);
        var inside = document.getElementById(d1).style.display;
        if(inside == "none")
        {
            document.getElementById(d1).style.display = "block";
            document.getElementById(b1).innerText = "Cancel";
        }
        else
        {
            document.getElementById(d1).style.display = "none";
            document.getElementById(b1).innerText = "Add your reply";
        }
    }
</script>
<div id="add_question" style="display: none;">       
        <div class="card" style="margin-right: 1rem;margin-left: 1rem;">
            <div class="container" style="margin-bottom: 2rem;margin-top: 2rem;">
                <form method="POST" style="margin-top:1.5rem;margin-bottom: 1.5rem;width: 100%;" action="http://localhost:3000/disc/<%= id %>/post">
               <span style="color: #000080;">Question:</span> 
               <textarea name="question" type="textarea" style="width:70rem;border:1px solid #000080;min-height: 10rem;"></textarea>
                  <p style="margin-top: 1rem;">
                    <span class="user_name">Select the tags into which your question falls into </span>  
                </p> 
                <label class="contain" style="display: inline;">                    
                    <span class="html" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">HTML</span>
                    <input name="post" value="html" type="checkbox">
                    <span class="checkmark"></span>
                </label>                
                <label class="contain" style="display: inline;">    
                    <span class="css" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">CSS</span>
                    <input name="post" value="css" type="checkbox">
                    <span class="checkmark"></span>
                </label>
                <label class="contain" style="display: inline;">
                    <span class="bootstrap" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">Bootstrap</span>
                    <input name="post" value="bootstrap" type="checkbox">
                    <span class="checkmark"></span>
                </label>
                <label class="contain" style="display: inline;">
                    <span class="js" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">Java Script</span>
                    <input name="post" value="js" type="checkbox" >
                    <span class="checkmark"></span>
                </label>
                <label class="contain" style="display: inline;">
                    <span class="jQuery" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">jQuery</span>
                    <input name="post" value="jQuery" type="checkbox" >
                    <span class="checkmark"></span>
                </label>
                <label class="contain" style="display: inline;">
                    <span class="angularJS" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">angularJS</span>
                    <input name="post" value="angularJS" type="checkbox" >
                    <span class="checkmark"></span>                    
                </label>
                <p></p>
                <p></p>
                <label class="contain" style="display: inline;">
                        <span class="json" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">JSON</span>
                        <input name="post" value="json" type="checkbox" >
                        <span class="checkmark"></span>
                        
                </label>
                <label class="contain" style="display: inline;">
                        <span class="ajax" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">Ajax</span>
                        <input name="post" value="ajax" type="checkbox" >
                        <span class="checkmark"></span>
                        
                </label>
                <label class="contain" style="display: inline;">
                        <span class="react" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">React</span>
                        <input name="post" value="react" type="checkbox" >
                        <span class="checkmark"></span>
                        
                </label>
                <label class="contain" style="display: inline;">
                        <span class="php" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">PHP</span>
                        <input name="post" value="php" type="checkbox" >
                        <span class="checkmark"></span>
                        
                </label>
                <label class="contain" style="display: inline;">
                        <span class="sql" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">SQL</span>
                        <input name="post" value="sql" type="checkbox" >
                        <span class="checkmark"></span>
                        
                </label>
                <label class="contain" style="display: inline;">
                        <span class="asp" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">ASP</span>
                        <input name="post" value="asp" type="checkbox" >
                        <span class="checkmark"></span>
                        
                </label>
                <label class="contain" style="display: inline;">
                        <span class="nodejs" style="padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;">Node.js</span>
                        <input name="post" value="nodejs" type="checkbox" >
                        <span class="checkmark"></span>       
                </label>
                <p></p>
                <input type="submit" value="Post" class="button" style="width: 100%;background: #000080;vertical-align:middle;">
                </form>
                </div>
        </div>
    </div>   

    <div style="margin-top: 1.5rem;background: white;width:100%;" id="divMain">
        <span class="divLeft" style="width:10%;">
            <a id="rcorners2" href="http://localhost:3000/disc/html">HTML</a>
            <a id="rcorners2" href="http://localhost:3000/disc/css">CSS</a> 
            <a id="rcorners2" href="http://localhost:3000/disc/bootstarp">Bootstrap</a>
            <a id="rcorners2" href="http://localhost:3000/disc/js">Java Script</a>
            <a id="rcorners2" href="http://localhost:3000/disc/jQuery">jQuery</a>
            <a id="rcorners2" href="http://localhost:3000/disc/angularJS">Angular JS</a>
            <a id="rcorners2" href="http://localhost:3000/disc/json">JSON</a>
            <a id="rcorners2" href="http://localhost:3000/disc/ajax">Ajax</a>
            <a id="rcorners2" href="http://localhost:3000/disc/react">React</a>
            <a id="rcorners2" href="http://localhost:3000/disc/php">PHP</a>
            <a id="rcorners2" href="http://localhost:3000/disc/sql">SQL</a>
            <a id="rcorners2" href="http://localhost:3000/disc/asp">ASP</a>
            <a id="rcorners2" href="http://localhost:3000/disc/nodejs">Node.js</a>
            </span>
        <span class="divRight" style="width:70%;">
            <% var it = 0;message.forEach((message) => { %>
            <div class="card" style="margin-bottom: 2rem;margin-top: 2rem;">
                <div class="container" style="margin-bottom: 2rem;margin-top: 2rem;">
                    <h4><b><%= message.question %></b> <button style="float: right;" class="like_b" onclick="flike(<%=it%>,<%= message.questionid %>)" id="blike0">Like</button></h4> 
                    <p style="margin-top: 1rem;">
                      <span class="user_name"><%= message.username %></span>
                      <span class="reply_info"><%= message.postedtime %></span>
                    </p>
                    <span  style="color:rgb(158, 163, 173);margin-left: 2rem;font-size: 1.5rem;">&#128065;</span>
                    <span style="font-family: 'Nunito', sans-serif;font-weight: bold;"><%= message.viewcount %></span>
                    <span style="color:red;margin-left: 2rem;">&#10084;</span>
                    <span style="font-family: 'Nunito', sans-serif;font-weight: bold;" id = "likes<%=it%>"><%= message.likes %></span>
                    <span style="color:cornflowerblue;margin-left: 2rem;font-size: 1.2rem;">&#9993;</span>
                    <span style="font-family: 'Nunito', sans-serif;font-weight: bold;"><%= message.commentscount %></span>
                    <p></p>
                    <% message.tags.forEach((tag) => { %>
                        <span class="<%= tag %>" style="margin:0.25rem;display:inline-block;padding-left: 1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;"><%= tag %></span>
                    <% }); %>
                    <p></p>
                    <button class="button" style="vertical-align:middle; margin-left: 0rem;background:#000000" onclick="f1(<%= it %>,<%= message.questionid %>)" id="b<%= it %>"><span>View all replies</span></button>
                    <button class="button" id="reply<%= it %>" style="vertical-align:middle;" onclick="f2(<%= it %>)"><span>Add your reply</span></button>
                
                    <div id="reply_class<%= it %>" class="card" style="display: none;">
                            <!-- <form method="POST" action="http://localhost:3000/disc/<%=id%>/q/<%=message.questionid%>" style="margin-top:1.5rem;margin-bottom: 1.5rem;width: 100%;"> -->
                        <textarea name="solution" id="info<%= it %>" type="text" style="width:100%;border:1px solid #000080;min-height: 10rem;"></textarea>
                        <input type="submit" name="POST" onclick="fun(<%= it %>,<%= message.questionid %>)" class="button" style="width: 12rem;background: #000080;">
                            <!-- </form> -->
                    </div>
                    <div id="class<%= it %>" style="display: none;">
                    </div>
                </div>
            </div>
            <% it++; }); %>
        </span>
        <script>
            function fun1(it,num){
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function(){
                    if(this.readyState == 4 && this.status == 200)
                    {
                        var json = JSON.parse(this.responseText);
                        document.getElementById("class"+it).innerHTML = "";
                        var count = 0;
                        console.log(json);
                        json.results.forEach(reply => {
                            document.getElementById("class"+it).innerHTML += '<p></p><div id="class'+count+'" class="card"><p style="margin-left: 2rem;"><span class="user_name">'+reply.username+'</span><span class="reply_info" >'+reply.postedtime+'</span></p> <p style="margin-left: 2rem;"><span>&#128077;</span>'+reply.upvotes+'<span style="margin-left:2rem;">&#128078;</span>'+reply.downvotes+'</p><p style="margin-left: 2rem;">'+reply.source+'</p></div>'
                        });
                    }
                };
                xhttp.open("GET","http://localhost:3000/disc/<%= id %>/q/"+num,true);
                xhttp.send();
            }
            function fun(it,num)
            {
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function(){
                    if(this.readyState == 4 && this.status == 200)
                    {
                        document.getElementById("reply_class"+it).style.display = "none";
                        document.getElementById("reply"+it).innerText = "Add your reply";
                        fun1(it,num);
                    }
                };
                xhttp.open("POST","http://localhost:3000/disc/<%= id %>/q/"+num,true);
                xhttp.setRequestHeader('Content-type',"application/x-www-form-urlencoded");
                var val_ = document.getElementById("info"+it).value;
                xhttp.send('solution='+val_);
            }
            function flike(it,num)
            {
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function(){
                    if(this.readyState == 4 && this.status == 200)
                    {
                        var json = JSON.parse(this.responseText);
                        document.getElementById("likes"+it).innerText = json.likes;
                        console.log(json);
                    }
                };
                xhttp.open("POST","http://localhost:3000/disc/<%= id %>/q/"+num+"/likes",true);
                // xhttp.setRequestHeader('Content-type',"application/x-www-form-urlencoded");
                xhttp.send();
            }
        </script>
        
    </div>
    <%- include part3.ejs %>